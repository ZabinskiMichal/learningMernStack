(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{16:function(e,t,a){},17:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(6),o=a.n(l),c=(a(16),a(3)),u=a(2);const s=Object(n.createContext)(),i=(e,t)=>{switch(t.type){case"LOGIN":return{user:t.payload};case"LOGOUT":return{user:null};default:return e}},m=e=>{let{children:t}=e;const[a,l]=Object(n.useReducer)(i,{user:null});return Object(n.useEffect)(()=>{const e=JSON.parse(localStorage.getItem("user"));e&&l({type:"LOGIN",payload:e})},[]),console.log("AuthContext state: ",a),r.a.createElement(s.Provider,{value:{...a,dispatch:l}},t)},d=()=>{const e=Object(n.useContext)(s);if(!e)throw Error("authContext must be used inside an AuthContextProvider");return e},p=Object(n.createContext)(),E=(e,t)=>{switch(t.type){case"SET_WORKOUTS":return{workouts:t.payload};case"CREATE_WORKOUT":return{workouts:[t.payload,...e.workouts]};case"DELETE_WORKOUT":return{workouts:e.workouts.filter(e=>e._id!==t.payload._id)};default:return e}},g=e=>{let{children:t}=e;const[a,l]=Object(n.useReducer)(E,{workouts:null});return r.a.createElement(p.Provider,{value:{...a,dispatch:l}},t)},h=()=>{const e=Object(n.useContext)(p);if(!e)throw Error("useWorkoutsContext must be used inside an WorkoutsContextProvider");return e};var b=a(7);function O(e){let{workout:t}=e;const{dispatch:a}=h(),{user:n}=d();return r.a.createElement("div",{className:"workout-details"},r.a.createElement("h4",null,t.title),r.a.createElement("p",null,r.a.createElement("strong",null,"Loag (kg): "),t.load),r.a.createElement("p",null,r.a.createElement("strong",null,"Reps: "),t.reps),r.a.createElement("p",null,Object(b.a)(new Date(t.createdAt),{addSuffix:!0})),r.a.createElement("span",{className:"material-symbols-outlined",onClick:async()=>{if(!n)return;const e=await fetch("/api/workouts/"+t._id,{method:"DELETE",headers:{Authorization:"Bearer ".concat(n.token)}}),r=await e.json();e.ok&&a({type:"DELETE_WORKOUT",payload:r})}},"delete"))}function y(){const{dispatch:e}=h(),{user:t}=d(),[a,l]=Object(n.useState)(""),[o,c]=Object(n.useState)(""),[u,s]=Object(n.useState)(""),[i,m]=Object(n.useState)(null),[p,E]=Object(n.useState)([]);return r.a.createElement("form",{className:"create",onSubmit:async n=>{if(n.preventDefault(),!t)return void m("You must be logged in");const r={title:a,load:o,reps:u},i=await fetch("/api/workouts",{method:"POST",body:JSON.stringify(r),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t.token)}}),d=await i.json();i.ok||(m(d.error),E(d.emptyFields)),i.ok&&(l(""),c(""),s(""),m(null),E([]),console.log("new workout added",d),e({type:"CREATE_WORKOUT",payload:d}))}},r.a.createElement("h3",null,"Add a new Workout"),r.a.createElement("label",null,"Exercise Title: "),r.a.createElement("input",{type:"text",onChange:e=>l(e.target.value),value:a,className:p.includes("title")?"error":""}),r.a.createElement("label",null,"Load (in Kg): "),r.a.createElement("input",{type:"number",onChange:e=>c(e.target.value),value:o,className:p.includes("load")?"error":""}),r.a.createElement("label",null,"Reps: "),r.a.createElement("input",{type:"number",onChange:e=>s(e.target.value),value:u,className:p.includes("reps")?"error":""}),r.a.createElement("button",null,"Add Workout"),i&&r.a.createElement("div",{className:"error"},i))}function f(){const{workouts:e,dispatch:t}=h(),{user:a}=d();return Object(n.useEffect)(()=>{a&&(async()=>{const e=await fetch("/api/workouts",{headers:{Authorization:"Bearer ".concat(a.token)}}),n=await e.json();e.ok&&t({type:"SET_WORKOUTS",payload:n})})()},[t,a]),r.a.createElement("div",{className:"home"},r.a.createElement("div",{className:"workours"},e&&e.map(e=>r.a.createElement(O,{key:e._id,workout:e}))),r.a.createElement(y,null))}function v(){const[e,t]=Object(n.useState)(""),[a,l]=Object(n.useState)(""),{login:o,error:c,isLoading:u}=(()=>{const[e,t]=Object(n.useState)(null),[a,r]=Object(n.useState)(null),{dispatch:l}=d();return{login:async(e,a)=>{r(!0),t(null);const n=await fetch("/api/user/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:a})});console.log(n);const o=await n.json();n.ok||(r(!1),t(o.error)),n.ok&&(localStorage.setItem("user",JSON.stringify(o)),l({type:"LOGIN",payload:o}),r(!1))},isLoading:a,error:e}})();return r.a.createElement("form",{className:"login",onSubmit:async t=>{t.preventDefault(),await o(e,a)}},r.a.createElement("h3",null,"Login"),r.a.createElement("label",null,"Email: "),r.a.createElement("input",{type:"email",onChange:e=>t(e.target.value),value:e}),r.a.createElement("input",{type:"password",onChange:e=>l(e.target.value),value:a}),r.a.createElement("button",{disabled:u},"Login"),c&&r.a.createElement("div",{className:"error"},c))}function w(){const[e,t]=Object(n.useState)(""),[a,l]=Object(n.useState)(""),{signup:o,error:c,isLoading:u}=(()=>{const[e,t]=Object(n.useState)(null),[a,r]=Object(n.useState)(null),{dispatch:l}=d();return{signup:async(e,a)=>{r(!0),t(null);const n=await fetch("/api/user/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:a})}),o=await n.json();n.ok||(r(!1),t(o.error)),n.ok&&(localStorage.setItem("user",JSON.stringify(o)),l({type:"LOGIN",payload:o}),r(!1))},isLoading:a,error:e}})();return r.a.createElement("form",{className:"signup",onSubmit:async t=>{t.preventDefault(),await o(e,a)}},r.a.createElement("h3",null,"Sign up"),r.a.createElement("label",null,"Email: "),r.a.createElement("input",{type:"email",onChange:e=>t(e.target.value),value:e}),r.a.createElement("input",{type:"password",onChange:e=>l(e.target.value),value:a}),r.a.createElement("button",{disabled:u},"Sign up"),c&&r.a.createElement("div",{className:"error"},c))}function S(){const{logout:e}=(()=>{const{dispatch:e}=d(),{dispatch:t}=h();return{logout:()=>{localStorage.removeItem("user"),e({type:"LOGOUT"}),t({type:"SET_WORKOUTS",payload:null})}}})(),{user:t}=d();return r.a.createElement("header",null,r.a.createElement("div",{className:"container"},r.a.createElement(c.b,{to:"/"},r.a.createElement("h1",null,"Workout Buddy ")),r.a.createElement("nav",null,t&&r.a.createElement("div",null,r.a.createElement("span",null,t.email),r.a.createElement("button",{onClick:()=>{e()}},"Logout")),!t&&r.a.createElement("div",null,r.a.createElement(c.b,{to:"/login"},"Login"),r.a.createElement(c.b,{to:"/signup"},"Signup")))))}var k=function(){const{user:e}=d();return r.a.createElement("div",{className:"App"},r.a.createElement(c.a,null,r.a.createElement(S,null),r.a.createElement("div",{className:"pages"},r.a.createElement(u.d,null,r.a.createElement(u.b,{path:"/",element:e?r.a.createElement(f,null):r.a.createElement(u.a,{to:"/login"})}),r.a.createElement(u.b,{path:"/login",element:e?r.a.createElement(u.a,{to:"/"}):r.a.createElement(v,null)}),r.a.createElement(u.b,{path:"/signup",element:e?r.a.createElement(u.a,{to:"/"}):r.a.createElement(w,null)})))))};a(18);o.a.createRoot(document.getElementById("root")).render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(m,null,r.a.createElement(g,null,r.a.createElement(k,null)))))},8:function(e,t,a){e.exports=a(17)}},[[8,1,2]]]);
//# sourceMappingURL=main.abcfa5e2.chunk.js.map